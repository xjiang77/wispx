<mxfile host="Electron" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/28.1.2 Chrome/138.0.7204.243 Electron/37.4.0 Safari/537.36" version="28.1.2">
  <diagram id="YpN22oSaBkMP8zXC4N8Y" name="Page-1">
    <mxGraphModel dx="1665" dy="859" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1800" pageHeight="1000" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title" value="Clawdbot Agent-Centric System Architecture" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=24;fontStyle=1;fontColor=#202124;" parent="1" vertex="1">
          <mxGeometry x="320" y="20" width="800" height="35" as="geometry" />
        </mxCell>
        <mxCell id="entry-layer" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#C6DAFC;strokeColor=#1A73E8;strokeWidth=1;arcSize=3;" parent="1" vertex="1">
          <mxGeometry x="40" y="85" width="180" height="620" as="geometry" />
        </mxCell>
        <mxCell id="entry-title" value="ENTRY LAYER (入口层)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=14;fontStyle=1;fontColor=#0D47A1;" parent="1" vertex="1">
          <mxGeometry x="50" y="90" width="160" height="35" as="geometry" />
        </mxCell>
        <mxCell id="msg-container" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#1A73E8;strokeWidth=1;dashed=1;arcSize=5;" parent="1" vertex="1">
          <mxGeometry x="50" y="130" width="160" height="175" as="geometry" />
        </mxCell>
        <mxCell id="msg-label" value="Messaging Channels" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=11;fontStyle=1;fontColor=#0D47A1;" parent="1" vertex="1">
          <mxGeometry x="55" y="133" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="telegram" value="Telegram" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#1A73E8;strokeWidth=1;fontSize=11;fontColor=#0D47A1;" parent="1" vertex="1">
          <mxGeometry x="60" y="157" width="140" height="28" as="geometry" />
        </mxCell>
        <mxCell id="discord" value="Discord" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#1A73E8;strokeWidth=1;fontSize=11;fontColor=#0D47A1;" parent="1" vertex="1">
          <mxGeometry x="60" y="190" width="140" height="28" as="geometry" />
        </mxCell>
        <mxCell id="whatsapp" value="WhatsApp" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#1A73E8;strokeWidth=1;fontSize=11;fontColor=#0D47A1;" parent="1" vertex="1">
          <mxGeometry x="60" y="223" width="140" height="28" as="geometry" />
        </mxCell>
        <mxCell id="imessage" value="Signal / iMessage / Slack / ..." style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#1A73E8;strokeWidth=1;fontSize=11;fontColor=#0D47A1;" parent="1" vertex="1">
          <mxGeometry x="60" y="256" width="140" height="28" as="geometry" />
        </mxCell>
        <mxCell id="native-container" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#1A73E8;strokeWidth=1;dashed=1;arcSize=5;" parent="1" vertex="1">
          <mxGeometry x="50" y="315" width="160" height="175" as="geometry" />
        </mxCell>
        <mxCell id="native-label" value="Native Interfaces" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=11;fontStyle=1;fontColor=#0D47A1;" parent="1" vertex="1">
          <mxGeometry x="55" y="318" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="web-ui" value="Web UI" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#1A73E8;strokeWidth=1;fontSize=11;fontColor=#0D47A1;" parent="1" vertex="1">
          <mxGeometry x="60" y="342" width="140" height="28" as="geometry" />
        </mxCell>
        <mxCell id="cli" value="CLI" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#1A73E8;strokeWidth=1;fontSize=11;fontColor=#0D47A1;" parent="1" vertex="1">
          <mxGeometry x="60" y="375" width="140" height="28" as="geometry" />
        </mxCell>
        <mxCell id="mac-mobile" value="Mac / Mobile Apps" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#1A73E8;strokeWidth=1;fontSize=11;fontColor=#0D47A1;" parent="1" vertex="1">
          <mxGeometry x="60" y="408" width="140" height="28" as="geometry" />
        </mxCell>
        <mxCell id="voice" value="Voice (Siri/Wake)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#1A73E8;strokeWidth=1;fontSize=11;fontColor=#0D47A1;" parent="1" vertex="1">
          <mxGeometry x="60" y="441" width="140" height="28" as="geometry" />
        </mxCell>
        <mxCell id="other-container" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#1A73E8;strokeWidth=1;dashed=1;arcSize=5;" parent="1" vertex="1">
          <mxGeometry x="50" y="500" width="160" height="105" as="geometry" />
        </mxCell>
        <mxCell id="other-label" value="Other Inputs" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=11;fontStyle=1;fontColor=#0D47A1;" parent="1" vertex="1">
          <mxGeometry x="55" y="503" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="api" value="HTTP API" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#1A73E8;strokeWidth=1;fontSize=11;fontColor=#0D47A1;" parent="1" vertex="1">
          <mxGeometry x="60" y="527" width="140" height="28" as="geometry" />
        </mxCell>
        <mxCell id="hooks-cron" value="Hooks / Cron" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#1A73E8;strokeWidth=1;fontSize=11;fontColor=#0D47A1;" parent="1" vertex="1">
          <mxGeometry x="60" y="560" width="140" height="28" as="geometry" />
        </mxCell>
        <mxCell id="gateway-layer" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FEEFC3;strokeColor=#E37400;strokeWidth=1;arcSize=3;" parent="1" vertex="1">
          <mxGeometry x="260" y="85" width="260" height="620" as="geometry" />
        </mxCell>
        <mxCell id="gateway-title" value="GATEWAY LAYER (网关层)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=14;fontStyle=1;fontColor=#5D4200;" parent="1" vertex="1">
          <mxGeometry x="280" y="90" width="220" height="35" as="geometry" />
        </mxCell>
        <mxCell id="local-deploy" value="LOCAL MODE&lt;br&gt;(本地模式)&lt;br&gt;&lt;br&gt;宿主: localhost&lt;br&gt;端口: 18789" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#E37400;strokeWidth=1;fontSize=10;fontColor=#5D4200;align=center;verticalAlign=top;spacingTop=5;" parent="1" vertex="1">
          <mxGeometry x="275" y="140" width="65" height="145" as="geometry" />
        </mxCell>
        <mxCell id="remote-deploy" value="REMOTE MODE&lt;br&gt;(远程模式)&lt;br&gt;&lt;br&gt;宿主: VPS&lt;br&gt;端口: 18789" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#E37400;strokeWidth=1;fontSize=10;fontColor=#5D4200;align=center;verticalAlign=top;spacingTop=5;" parent="1" vertex="1">
          <mxGeometry x="275" y="295" width="65" height="145" as="geometry" />
        </mxCell>
        <mxCell id="tailscale" value="TAIL&lt;br&gt;SCALE&lt;br&gt;&lt;br&gt;VPN&lt;br&gt;内网" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#E37400;strokeWidth=1;fontSize=11;fontColor=#5D4200;align=center;verticalAlign=middle;" parent="1" vertex="1">
          <mxGeometry x="350" y="140" width="50" height="300" as="geometry" />
        </mxCell>
        <mxCell id="msg-queue" value="WebSocket&lt;br&gt;Handlers&lt;br&gt;(实时消息)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#E37400;strokeWidth=1;fontSize=11;fontColor=#5D4200;align=center;verticalAlign=middle;" parent="1" vertex="1">
          <mxGeometry x="415" y="140" width="90" height="70" as="geometry" />
        </mxCell>
        <mxCell id="auth-security" value="HTTP API&lt;br&gt;(REST)&lt;br&gt;:18789" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#E37400;strokeWidth=1;fontSize=11;fontColor=#5D4200;align=center;verticalAlign=middle;" parent="1" vertex="1">
          <mxGeometry x="415" y="220" width="90" height="70" as="geometry" />
        </mxCell>
        <mxCell id="media-pipeline" value="Node Mgmt&lt;br&gt;(设备管理)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#E37400;strokeWidth=1;fontSize=11;fontColor=#5D4200;align=center;verticalAlign=middle;" parent="1" vertex="1">
          <mxGeometry x="415" y="300" width="90" height="70" as="geometry" />
        </mxCell>
        <mxCell id="node-mgmt" value="Cron Jobs&lt;br&gt;(定时任务)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#E37400;strokeWidth=1;fontSize=11;fontColor=#5D4200;align=center;verticalAlign=middle;" parent="1" vertex="1">
          <mxGeometry x="415" y="380" width="90" height="70" as="geometry" />
        </mxCell>
        <mxCell id="gw-security-label" value="Security &amp; Auth" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=11;fontStyle=1;fontColor=#5D4200;" parent="1" vertex="1">
          <mxGeometry x="275" y="455" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="gw-auth" value="Token Auth" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#E37400;strokeWidth=1;fontSize=10;fontColor=#5D4200;" parent="1" vertex="1">
          <mxGeometry x="275" y="480" width="105" height="28" as="geometry" />
        </mxCell>
        <mxCell id="gw-rate" value="Rate Limiting" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#E37400;strokeWidth=1;fontSize=10;fontColor=#5D4200;" parent="1" vertex="1">
          <mxGeometry x="390" y="480" width="105" height="28" as="geometry" />
        </mxCell>
        <mxCell id="gw-allowlist" value="Allowlist" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#E37400;strokeWidth=1;fontSize=10;fontColor=#5D4200;" parent="1" vertex="1">
          <mxGeometry x="275" y="515" width="105" height="28" as="geometry" />
        </mxCell>
        <mxCell id="gw-ssl" value="SSL/TLS" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#E37400;strokeWidth=1;fontSize=10;fontColor=#5D4200;" parent="1" vertex="1">
          <mxGeometry x="390" y="515" width="105" height="28" as="geometry" />
        </mxCell>
        <mxCell id="gw-routing-label" value="Message Routing" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=11;fontStyle=1;fontColor=#5D4200;" parent="1" vertex="1">
          <mxGeometry x="275" y="555" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="gw-routing" value="Channel Router → Agent Dispatcher" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#E37400;strokeWidth=1;fontSize=10;fontColor=#5D4200;" parent="1" vertex="1">
          <mxGeometry x="275" y="580" width="220" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gw-media" value="Media Pipeline (上传/下载)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#E37400;strokeWidth=1;fontSize=10;fontColor=#5D4200;" parent="1" vertex="1">
          <mxGeometry x="275" y="625" width="220" height="40" as="geometry" />
        </mxCell>
        <mxCell id="agent-layer" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#CEEAD6;strokeColor=#188038;strokeWidth=3;arcSize=3;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="560" y="85" width="620" height="620" as="geometry" />
        </mxCell>
        <mxCell id="agent-title" value="AGENT LAYER (代理层 - 架构核心)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=16;fontStyle=1;fontColor=#0B5323;" parent="1" vertex="1">
          <mxGeometry x="570" y="90" width="600" height="35" as="geometry" />
        </mxCell>
        <mxCell id="llm-label" value="LLM Orchestration" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=11;fontStyle=1;fontColor=#0B5323;" parent="1" vertex="1">
          <mxGeometry x="580" y="125" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="llm-orch" value="Provider Router | Streaming | Model Selection | Fallback" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#A8DAB5;strokeColor=#188038;strokeWidth=1;fontSize=10;fontColor=#0B5323;" parent="1" vertex="1">
          <mxGeometry x="580" y="147" width="580" height="35" as="geometry" />
        </mxCell>
        <mxCell id="state-label" value="State Management" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=11;fontStyle=1;fontColor=#0B5323;" parent="1" vertex="1">
          <mxGeometry x="580" y="190" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="session" value="Session (短期记忆)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#A8DAB5;strokeColor=#188038;strokeWidth=1;fontSize=10;fontColor=#0B5323;" parent="1" vertex="1">
          <mxGeometry x="580" y="212" width="135" height="40" as="geometry" />
        </mxCell>
        <mxCell id="memory" value="Memory (长期记忆)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#A8DAB5;strokeColor=#188038;strokeWidth=1;fontSize=10;fontColor=#0B5323;" parent="1" vertex="1">
          <mxGeometry x="725" y="212" width="135" height="40" as="geometry" />
        </mxCell>
        <mxCell id="context-mgmt" value="Context Mgmt" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#A8DAB5;strokeColor=#188038;strokeWidth=1;fontSize=10;fontColor=#0B5323;" parent="1" vertex="1">
          <mxGeometry x="870" y="212" width="135" height="40" as="geometry" />
        </mxCell>
        <mxCell id="guardrails" value="Guardrails (Safety)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#A8DAB5;strokeColor=#188038;strokeWidth=1;fontSize=10;fontColor=#0B5323;" parent="1" vertex="1">
          <mxGeometry x="1015" y="212" width="135" height="40" as="geometry" />
        </mxCell>
        <mxCell id="loop-label" value="Agent Runtime (Agentic Loop/Pi-Agent)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=11;fontStyle=1;fontColor=#0B5323;" parent="1" vertex="1">
          <mxGeometry x="580" y="260" width="250" height="20" as="geometry" />
        </mxCell>
        <mxCell id="loop-scenario" value="场景: &quot;帮我生成一个项目进度 PPT&quot;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=10;fontStyle=2;fontColor=#0B5323;" parent="1" vertex="1">
          <mxGeometry x="580" y="280" width="300" height="18" as="geometry" />
        </mxCell>
        <mxCell id="loop-container" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#188038;strokeWidth=1;arcSize=3;dashed=1;" parent="1" vertex="1">
          <mxGeometry x="580" y="300" width="580" height="130" as="geometry" />
        </mxCell>
        <mxCell id="step1" value="1. 理解意图&lt;br&gt;Analyze 分析&lt;br&gt;→ 需要 /pptx" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#CEEAD6;strokeColor=#188038;strokeWidth=1;fontSize=9;fontColor=#0B5323;" parent="1" vertex="1">
          <mxGeometry x="595" y="310" width="120" height="55" as="geometry" />
        </mxCell>
        <mxCell id="step2" value="2. 调用工具&lt;br&gt;Request&lt;br&gt;{ skill: &quot;pptx&quot; }" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#CEEAD6;strokeColor=#188038;strokeWidth=1;fontSize=9;fontColor=#0B5323;" parent="1" vertex="1">
          <mxGeometry x="735" y="310" width="120" height="55" as="geometry" />
        </mxCell>
        <mxCell id="step3" value="3. 执行工具&lt;br&gt;Execute&lt;br&gt;验证 + 执行" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#CEEAD6;strokeColor=#188038;strokeWidth=1;fontSize=9;fontColor=#0B5323;" parent="1" vertex="1">
          <mxGeometry x="875" y="310" width="120" height="55" as="geometry" />
        </mxCell>
        <mxCell id="step4" value="4. 返回/继续&lt;br&gt;Return/Loop&lt;br&gt;循环或回复" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#CEEAD6;strokeColor=#188038;strokeWidth=1;fontSize=9;fontColor=#0B5323;" parent="1" vertex="1">
          <mxGeometry x="1015" y="310" width="120" height="55" as="geometry" />
        </mxCell>
        <mxCell id="arrow1" value="" style="endArrow=classic;html=1;strokeColor=#188038;strokeWidth=1.5;entryX=0;entryY=0.5;exitX=1;exitY=0.5;" parent="1" source="step1" target="step2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow2" value="" style="endArrow=classic;html=1;strokeColor=#188038;strokeWidth=1.5;entryX=0;entryY=0.5;exitX=1;exitY=0.5;" parent="1" source="step2" target="step3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow3" value="" style="endArrow=classic;html=1;strokeColor=#188038;strokeWidth=1.5;entryX=0;entryY=0.5;exitX=1;exitY=0.5;" parent="1" source="step3" target="step4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="loop-back" value="循环" style="endArrow=classic;html=1;strokeColor=#188038;strokeWidth=1.5;curved=1;dashed=1;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1140" y="400" />
              <mxPoint x="940" y="405" />
              <mxPoint x="770" y="400" />
            </Array>
            <mxPoint x="1140" y="370" as="sourcePoint" />
            <mxPoint x="770" y="370" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tools-label" value="TOOLS (工具层)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=11;fontStyle=1;fontColor=#0B5323;" parent="1" vertex="1">
          <mxGeometry x="580" y="440" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tools-container" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#A8DAB5;strokeColor=#188038;strokeWidth=1;arcSize=5;" parent="1" vertex="1">
          <mxGeometry x="580" y="460" width="280" height="65" as="geometry" />
        </mxCell>
        <mxCell id="tools-items" value="File Ops | Browser | Shell | MCP Tools&lt;br&gt;Tool Executor: 验证 → 执行 → 返回 → 重试" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=10;fontColor=#0B5323;" parent="1" vertex="1">
          <mxGeometry x="590" y="468" width="260" height="45" as="geometry" />
        </mxCell>
        <mxCell id="skills-label" value="SKILLS (技能系统)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=11;fontStyle=1;fontColor=#0B5323;" parent="1" vertex="1">
          <mxGeometry x="880" y="440" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="skills-container" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#A8DAB5;strokeColor=#188038;strokeWidth=1;arcSize=5;" parent="1" vertex="1">
          <mxGeometry x="880" y="460" width="280" height="65" as="geometry" />
        </mxCell>
        <mxCell id="skills-items" value="文档: /pptx /pdf /docx | 代码: /commit /review-pr&lt;br&gt;Skill Loader: 动态加载 → MCP Client 连接" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=10;fontColor=#0B5323;" parent="1" vertex="1">
          <mxGeometry x="890" y="468" width="260" height="45" as="geometry" />
        </mxCell>
        <mxCell id="ext-label" value="Extensions" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=11;fontStyle=1;fontColor=#0B5323;" parent="1" vertex="1">
          <mxGeometry x="580" y="535" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="hooks-plugins" value="Hooks &amp; Plugins (Extension Points)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#A8DAB5;strokeColor=#188038;strokeWidth=1;fontSize=10;fontColor=#0B5323;" parent="1" vertex="1">
          <mxGeometry x="580" y="557" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="agent-commands" value="Agent Commands (Built-in Actions)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#A8DAB5;strokeColor=#188038;strokeWidth=1;fontSize=10;fontColor=#0B5323;" parent="1" vertex="1">
          <mxGeometry x="770" y="557" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="persona" value="Persona &amp; Config (System Prompt)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#A8DAB5;strokeColor=#188038;strokeWidth=1;fontSize=10;fontColor=#0B5323;" parent="1" vertex="1">
          <mxGeometry x="960" y="557" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="output-label" value="Output Processing" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=11;fontStyle=1;fontColor=#0B5323;" parent="1" vertex="1">
          <mxGeometry x="580" y="605" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="output-format" value="Response Formatter" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#A8DAB5;strokeColor=#188038;strokeWidth=1;fontSize=10;fontColor=#0B5323;" parent="1" vertex="1">
          <mxGeometry x="580" y="627" width="140" height="35" as="geometry" />
        </mxCell>
        <mxCell id="output-media" value="Media Attachment" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#A8DAB5;strokeColor=#188038;strokeWidth=1;fontSize=10;fontColor=#0B5323;" parent="1" vertex="1">
          <mxGeometry x="730" y="627" width="140" height="35" as="geometry" />
        </mxCell>
        <mxCell id="output-stream" value="Streaming Output" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#A8DAB5;strokeColor=#188038;strokeWidth=1;fontSize=10;fontColor=#0B5323;" parent="1" vertex="1">
          <mxGeometry x="880" y="627" width="140" height="35" as="geometry" />
        </mxCell>
        <mxCell id="output-error" value="Error Handler" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#A8DAB5;strokeColor=#188038;strokeWidth=1;fontSize=10;fontColor=#0B5323;" parent="1" vertex="1">
          <mxGeometry x="1030" y="627" width="140" height="35" as="geometry" />
        </mxCell>
        <mxCell id="external-layer" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FAD2CF;strokeColor=#C5221F;strokeWidth=1;arcSize=3;" parent="1" vertex="1">
          <mxGeometry x="1220" y="85" width="180" height="620" as="geometry" />
        </mxCell>
        <mxCell id="external-title" value="EXTERNAL (外部服务)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=14;fontStyle=1;fontColor=#7F0000;" parent="1" vertex="1">
          <mxGeometry x="1230" y="90" width="160" height="35" as="geometry" />
        </mxCell>
        <mxCell id="llm-providers-label" value="LLM Providers" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=11;fontStyle=1;fontColor=#7F0000;" parent="1" vertex="1">
          <mxGeometry x="1230" y="125" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="anthropic" value="Anthropic (Claude)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#C5221F;strokeWidth=1;fontSize=10;fontColor=#7F0000;" parent="1" vertex="1">
          <mxGeometry x="1230" y="147" width="160" height="28" as="geometry" />
        </mxCell>
        <mxCell id="openai" value="OpenAI (GPT)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#C5221F;strokeWidth=1;fontSize=10;fontColor=#7F0000;" parent="1" vertex="1">
          <mxGeometry x="1230" y="180" width="160" height="28" as="geometry" />
        </mxCell>
        <mxCell id="google" value="Google (Gemini)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#C5221F;strokeWidth=1;fontSize=10;fontColor=#7F0000;" parent="1" vertex="1">
          <mxGeometry x="1230" y="213" width="160" height="28" as="geometry" />
        </mxCell>
        <mxCell id="deepseek" value="DeepSeek" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#C5221F;strokeWidth=1;fontSize=10;fontColor=#7F0000;" parent="1" vertex="1">
          <mxGeometry x="1230" y="246" width="160" height="28" as="geometry" />
        </mxCell>
        <mxCell id="ollama" value="Ollama (Local)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#C5221F;strokeWidth=1;fontSize=10;fontColor=#7F0000;" parent="1" vertex="1">
          <mxGeometry x="1230" y="279" width="160" height="28" as="geometry" />
        </mxCell>
        <mxCell id="ext-svc-label" value="External Services" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=11;fontStyle=1;fontColor=#7F0000;" parent="1" vertex="1">
          <mxGeometry x="1230" y="315" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="mcp-servers" value="MCP Servers" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#C5221F;strokeWidth=1;fontSize=10;fontColor=#7F0000;" parent="1" vertex="1">
          <mxGeometry x="1230" y="337" width="160" height="28" as="geometry" />
        </mxCell>
        <mxCell id="webhooks" value="Webhooks" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#C5221F;strokeWidth=1;fontSize=10;fontColor=#7F0000;" parent="1" vertex="1">
          <mxGeometry x="1230" y="370" width="160" height="28" as="geometry" />
        </mxCell>
        <mxCell id="third-party" value="Third-party APIs" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#C5221F;strokeWidth=1;fontSize=10;fontColor=#7F0000;" parent="1" vertex="1">
          <mxGeometry x="1230" y="403" width="160" height="28" as="geometry" />
        </mxCell>
        <mxCell id="storage-label" value="Storage &amp; Search" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=11;fontStyle=1;fontColor=#7F0000;" parent="1" vertex="1">
          <mxGeometry x="1230" y="440" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="vector-db" value="Vector DB (RAG)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#C5221F;strokeWidth=1;fontSize=10;fontColor=#7F0000;" parent="1" vertex="1">
          <mxGeometry x="1230" y="462" width="160" height="28" as="geometry" />
        </mxCell>
        <mxCell id="cloud-storage" value="Cloud Storage" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#C5221F;strokeWidth=1;fontSize=10;fontColor=#7F0000;" parent="1" vertex="1">
          <mxGeometry x="1230" y="495" width="160" height="28" as="geometry" />
        </mxCell>
        <mxCell id="search-apis" value="Search APIs" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#C5221F;strokeWidth=1;fontSize=10;fontColor=#7F0000;" parent="1" vertex="1">
          <mxGeometry x="1230" y="528" width="160" height="28" as="geometry" />
        </mxCell>
        <mxCell id="media-label" value="Media Services" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=11;fontStyle=1;fontColor=#7F0000;" parent="1" vertex="1">
          <mxGeometry x="1230" y="565" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tts-stt" value="TTS / STT" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#C5221F;strokeWidth=1;fontSize=10;fontColor=#7F0000;" parent="1" vertex="1">
          <mxGeometry x="1230" y="587" width="160" height="28" as="geometry" />
        </mxCell>
        <mxCell id="image-gen" value="Image Gen (DALL-E, etc.)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#C5221F;strokeWidth=1;fontSize=10;fontColor=#7F0000;" parent="1" vertex="1">
          <mxGeometry x="1230" y="620" width="160" height="28" as="geometry" />
        </mxCell>
        <mxCell id="video-proc" value="Video Processing" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#C5221F;strokeWidth=1;fontSize=10;fontColor=#7F0000;" parent="1" vertex="1">
          <mxGeometry x="1230" y="653" width="160" height="28" as="geometry" />
        </mxCell>
        <mxCell id="infra-layer" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F1F3F4;strokeColor=#5F6368;strokeWidth=1;arcSize=3;" parent="1" vertex="1">
          <mxGeometry x="40" y="755" width="1360" height="120" as="geometry" />
        </mxCell>
        <mxCell id="infra-title" value="INFRASTRUCTURE (基础设施)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=14;fontStyle=1;fontColor=#202124;" parent="1" vertex="1">
          <mxGeometry x="40" y="760" width="1360" height="35" as="geometry" />
        </mxCell>
        <mxCell id="crypto" value="Crypto (Keys)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#5F6368;strokeWidth=1;fontSize=10;fontColor=#202124;" parent="1" vertex="1">
          <mxGeometry x="60" y="805" width="175" height="30" as="geometry" />
        </mxCell>
        <mxCell id="processes" value="Process (Spawn/IPC)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#5F6368;strokeWidth=1;fontSize=10;fontColor=#202124;" parent="1" vertex="1">
          <mxGeometry x="250" y="805" width="175" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cache" value="Cache (Memory)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#5F6368;strokeWidth=1;fontSize=10;fontColor=#202124;" parent="1" vertex="1">
          <mxGeometry x="440" y="805" width="175" height="30" as="geometry" />
        </mxCell>
        <mxCell id="logging" value="Logging (Unified)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#5F6368;strokeWidth=1;fontSize=10;fontColor=#202124;" parent="1" vertex="1">
          <mxGeometry x="630" y="805" width="175" height="30" as="geometry" />
        </mxCell>
        <mxCell id="config" value="Config (Settings)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#5F6368;strokeWidth=1;fontSize=10;fontColor=#202124;" parent="1" vertex="1">
          <mxGeometry x="820" y="805" width="175" height="30" as="geometry" />
        </mxCell>
        <mxCell id="filesystem" value="FileSystem (Storage)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#5F6368;strokeWidth=1;fontSize=10;fontColor=#202124;" parent="1" vertex="1">
          <mxGeometry x="1010" y="805" width="175" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sqlite" value="SQLite (Data)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#5F6368;strokeWidth=1;fontSize=10;fontColor=#202124;" parent="1" vertex="1">
          <mxGeometry x="1205" y="805" width="175" height="30" as="geometry" />
        </mxCell>
        <mxCell id="node-env" value="Node.js / Bun Runtime" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#5F6368;strokeWidth=1;fontSize=10;fontColor=#202124;" parent="1" vertex="1">
          <mxGeometry x="60" y="840" width="330" height="30" as="geometry" />
        </mxCell>
        <mxCell id="os-layer" value="OS Layer (macOS / Linux / Windows)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#5F6368;strokeWidth=1;fontSize=10;fontColor=#202124;" parent="1" vertex="1">
          <mxGeometry x="405" y="840" width="330" height="30" as="geometry" />
        </mxCell>
        <mxCell id="network" value="Network (HTTP/WS/IPC)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#5F6368;strokeWidth=1;fontSize=10;fontColor=#202124;" parent="1" vertex="1">
          <mxGeometry x="750" y="840" width="330" height="30" as="geometry" />
        </mxCell>
        <mxCell id="security" value="Security (Sandbox/Permissions)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#5F6368;strokeWidth=1;fontSize=10;fontColor=#202124;" parent="1" vertex="1">
          <mxGeometry x="1095" y="840" width="285" height="30" as="geometry" />
        </mxCell>
        <mxCell id="conn-entry-gw" value="" style="endArrow=classic;html=1;strokeColor=#1A73E8;strokeWidth=2;exitX=1;exitY=0.5;entryX=0;entryY=0.3;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="220" y="355" as="sourcePoint" />
            <mxPoint x="260" y="355" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conn-entry-gw-label" value="消息" style="text;html=1;strokeColor=none;fillColor=#FFFFFF;align=center;verticalAlign=middle;fontSize=9;fontColor=#1A73E8;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="225" y="335" width="30" height="16" as="geometry" />
        </mxCell>
        <mxCell id="conn-gw-agent" value="" style="endArrow=classic;html=1;strokeColor=#E37400;strokeWidth=2;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="520" y="355" as="sourcePoint" />
            <mxPoint x="560" y="355" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conn-gw-agent-label" value="路由" style="text;html=1;strokeColor=none;fillColor=#FFFFFF;align=center;verticalAlign=middle;fontSize=9;fontColor=#E37400;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="525" y="335" width="30" height="16" as="geometry" />
        </mxCell>
        <mxCell id="conn-agent-ext-req" value="" style="endArrow=classic;html=1;strokeColor=#C5221F;strokeWidth=2;exitX=1;exitY=0.3;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1180" y="255" as="sourcePoint" />
            <mxPoint x="1220" y="255" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conn-agent-ext-req-label" value="API 请求" style="text;html=1;strokeColor=none;fillColor=#FFFFFF;align=center;verticalAlign=middle;fontSize=9;fontColor=#C5221F;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="1183" y="233" width="50" height="16" as="geometry" />
        </mxCell>
        <mxCell id="conn-ext-agent-res" value="" style="endArrow=classic;html=1;strokeColor=#C5221F;strokeWidth=2;dashed=1;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1220" y="455" as="sourcePoint" />
            <mxPoint x="1180" y="455" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conn-ext-agent-res-label" value="响应" style="text;html=1;strokeColor=none;fillColor=#FFFFFF;align=center;verticalAlign=middle;fontSize=9;fontColor=#C5221F;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="1188" y="460" width="30" height="16" as="geometry" />
        </mxCell>
        <mxCell id="conn-agent-infra" value="" style="endArrow=classic;html=1;strokeColor=#5F6368;strokeWidth=2;dashed=1;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="870" y="705" as="sourcePoint" />
            <mxPoint x="870" y="755" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conn-agent-infra-label" value="存储/日志" style="text;html=1;strokeColor=none;fillColor=#FFFFFF;align=center;verticalAlign=middle;fontSize=9;fontColor=#5F6368;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="878" y="720" width="55" height="16" as="geometry" />
        </mxCell>
        <mxCell id="conn-agent-gw-res" value="" style="endArrow=classic;html=1;strokeColor=#188038;strokeWidth=2;dashed=1;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="560" y="555" as="sourcePoint" />
            <mxPoint x="520" y="555" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conn-agent-gw-res-label" value="回复" style="text;html=1;strokeColor=none;fillColor=#FFFFFF;align=center;verticalAlign=middle;fontSize=9;fontColor=#188038;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="525" y="560" width="30" height="16" as="geometry" />
        </mxCell>
        <mxCell id="conn-gw-entry-res" value="" style="endArrow=classic;html=1;strokeColor=#188038;strokeWidth=2;dashed=1;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="260" y="555" as="sourcePoint" />
            <mxPoint x="220" y="555" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conn-gw-entry-res-label" value="推送" style="text;html=1;strokeColor=none;fillColor=#FFFFFF;align=center;verticalAlign=middle;fontSize=9;fontColor=#188038;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="225" y="560" width="30" height="16" as="geometry" />
        </mxCell>
        <mxCell id="legend-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#5F6368;strokeWidth=1;arcSize=5;" parent="1" vertex="1">
          <mxGeometry x="1435" y="87" width="175" height="155" as="geometry" />
        </mxCell>
        <mxCell id="legend-title" value="图例 Legend" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=11;fontStyle=1;fontColor=#202124;" parent="1" vertex="1">
          <mxGeometry x="1445" y="92" width="100" height="18" as="geometry" />
        </mxCell>
        <mxCell id="legend-entry" value="入口层" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#C6DAFC;strokeColor=#1A73E8;strokeWidth=1;fontSize=9;fontColor=#0D47A1;" parent="1" vertex="1">
          <mxGeometry x="1445" y="112" width="70" height="18" as="geometry" />
        </mxCell>
        <mxCell id="legend-gateway" value="网关层" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FEEFC3;strokeColor=#E37400;strokeWidth=1;fontSize=9;fontColor=#5D4200;" parent="1" vertex="1">
          <mxGeometry x="1525" y="112" width="70" height="18" as="geometry" />
        </mxCell>
        <mxCell id="legend-agent" value="代理层 (核心)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#CEEAD6;strokeColor=#188038;strokeWidth=1;fontSize=9;fontColor=#0B5323;" parent="1" vertex="1">
          <mxGeometry x="1445" y="134" width="70" height="18" as="geometry" />
        </mxCell>
        <mxCell id="legend-external" value="外部服务" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FAD2CF;strokeColor=#C5221F;strokeWidth=1;fontSize=9;fontColor=#7F0000;" parent="1" vertex="1">
          <mxGeometry x="1525" y="134" width="70" height="18" as="geometry" />
        </mxCell>
        <mxCell id="legend-infra" value="基础设施" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F1F3F4;strokeColor=#5F6368;strokeWidth=1;fontSize=9;fontColor=#202124;" parent="1" vertex="1">
          <mxGeometry x="1445" y="156" width="70" height="18" as="geometry" />
        </mxCell>
        <mxCell id="legend-arrow-req" value="─→ 请求流" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=9;fontColor=#202124;" parent="1" vertex="1">
          <mxGeometry x="1445" y="182" width="70" height="18" as="geometry" />
        </mxCell>
        <mxCell id="legend-arrow-res" value="┄→ 响应流" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=9;fontColor=#202124;" parent="1" vertex="1">
          <mxGeometry x="1525" y="182" width="70" height="18" as="geometry" />
        </mxCell>
        <mxCell id="legend-arrow-int" value="┄→ 内部调用" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=9;fontColor=#202124;" parent="1" vertex="1">
          <mxGeometry x="1445" y="202" width="80" height="18" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
