<?xml version="1.0" encoding="UTF-8"?>
<mxfile host="app.diagrams.net" agent="Claude" version="26.0.4">
  <diagram name="Clawdbot Architecture - Professional" id="clawdbot-v3-professional">
    <mxGraphModel dx="1200" dy="800" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="900" math="0" shadow="1">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- Title -->
        <mxCell id="title" value="Clawdbot System Architecture" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=28;fontStyle=1;fontColor=#2C3E50;fontFamily=Helvetica;" vertex="1" parent="1">
          <mxGeometry x="550" y="15" width="500" height="50" as="geometry" />
        </mxCell>
        <mxCell id="subtitle" value="Agent-Centric Architecture with Multi-Channel Support" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=2;fontColor=#7F8C8D;" vertex="1" parent="1">
          <mxGeometry x="550" y="55" width="500" height="20" as="geometry" />
        </mxCell>

        <!-- ENTRY LAYER - Orange Theme #FF8C42 -->
        <mxCell id="entry-layer" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF4E6;strokeColor=#FF8C42;strokeWidth=2;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="80" y="85" width="840" height="110" as="geometry" />
        </mxCell>
        <mxCell id="entry-label" value="ENTRY LAYER" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=13;fontStyle=1;fontColor=#FF8C42;" vertex="1" parent="1">
          <mxGeometry x="90" y="90" width="120" height="18" as="geometry" />
        </mxCell>
        <mxCell id="entry-sublabel" value="Messaging Channels &amp; User Interfaces" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=0;fontColor=#95A5A6;" vertex="1" parent="1">
          <mxGeometry x="220" y="92" width="220" height="16" as="geometry" />
        </mxCell>

        <!-- Entry Layer - Channels -->
        <mxCell id="channels-group" value="Channels" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=2;fontColor=#7F8C8D;" vertex="1" parent="1">
          <mxGeometry x="120" y="112" width="60" height="14" as="geometry" />
        </mxCell>
        <mxCell id="telegram" value="Telegram" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FF8C42;strokeColor=#E67E22;fontColor=#FFFFFF;fontStyle=1;fontSize=11;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="120" y="128" width="90" height="50" as="geometry" />
        </mxCell>
        <mxCell id="discord" value="Discord" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FF8C42;strokeColor=#E67E22;fontColor=#FFFFFF;fontStyle=1;fontSize=11;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="230" y="128" width="90" height="50" as="geometry" />
        </mxCell>
        <mxCell id="whatsapp" value="WhatsApp" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FF8C42;strokeColor=#E67E22;fontColor=#FFFFFF;fontStyle=1;fontSize=11;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="340" y="128" width="90" height="50" as="geometry" />
        </mxCell>

        <!-- Entry Layer - User Interfaces -->
        <mxCell id="ui-group" value="User Interfaces" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=2;fontColor=#7F8C8D;" vertex="1" parent="1">
          <mxGeometry x="560" y="112" width="80" height="14" as="geometry" />
        </mxCell>
        <mxCell id="webui" value="Web UI" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFAB76;strokeColor=#FF8C42;fontColor=#2C3E50;fontStyle=1;fontSize=11;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="560" y="128" width="90" height="50" as="geometry" />
        </mxCell>
        <mxCell id="mobile" value="Mobile Apps" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFAB76;strokeColor=#FF8C42;fontColor=#2C3E50;fontStyle=1;fontSize=11;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="670" y="128" width="90" height="50" as="geometry" />
        </mxCell>
        <mxCell id="cli" value="CLI" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFAB76;strokeColor=#FF8C42;fontColor=#2C3E50;fontStyle=1;fontSize=11;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="780" y="128" width="70" height="50" as="geometry" />
        </mxCell>

        <!-- Arrow: Entry to Gateway -->
        <mxCell id="arrow-entry-gateway" value="" style="endArrow=classic;html=1;strokeWidth=2;strokeColor=#5B9BD5;shadow=1;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="500" y="195" as="sourcePoint" />
            <mxPoint x="500" y="215" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- GATEWAY LAYER - Orange Theme (lighter) -->
        <mxCell id="gateway-layer" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF9F0;strokeColor=#FFB300;strokeWidth=2;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="80" y="215" width="840" height="165" as="geometry" />
        </mxCell>
        <mxCell id="gateway-label" value="GATEWAY LAYER" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=13;fontStyle=1;fontColor=#FFB300;" vertex="1" parent="1">
          <mxGeometry x="90" y="220" width="140" height="18" as="geometry" />
        </mxCell>
        <mxCell id="gateway-sublabel" value="Routing, Authentication &amp; Connection Management" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=0;fontColor=#95A5A6;" vertex="1" parent="1">
          <mxGeometry x="240" y="222" width="280" height="16" as="geometry" />
        </mxCell>

        <!-- Gateway Connection Modes - Vertical Layout -->
        <mxCell id="modes-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#FFB300;strokeWidth=1;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="100" y="243" width="170" height="130" as="geometry" />
        </mxCell>
        <mxCell id="modes-label" value="Connection Modes" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=3;fontColor=#95A5A6;" vertex="1" parent="1">
          <mxGeometry x="110" y="246" width="120" height="14" as="geometry" />
        </mxCell>

        <mxCell id="local-mode" value="LOCAL&#xa;localhost:18789" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#66BB6A;strokeColor=#4CAF50;fontColor=#FFFFFF;fontStyle=1;fontSize=9;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="115" y="264" width="140" height="32" as="geometry" />
        </mxCell>
        <mxCell id="remote-mode" value="REMOTE&#xa;0.0.0.0:18789" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFB300;strokeColor=#FFA000;fontColor=#FFFFFF;fontStyle=1;fontSize=9;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="115" y="301" width="140" height="32" as="geometry" />
        </mxCell>
        <mxCell id="tailscale-mode" value="TAILSCALE&#xa;serve / funnel" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#AB47BC;strokeColor=#8E24AA;fontColor=#FFFFFF;fontStyle=1;fontSize=9;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="115" y="338" width="140" height="32" as="geometry" />
        </mxCell>

        <!-- Gateway Core Components - Grid Layout -->
        <mxCell id="components-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#FFB300;strokeWidth=1;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="285" y="243" width="260" height="130" as="geometry" />
        </mxCell>
        <mxCell id="gateway-components" value="Core Services" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=3;fontColor=#95A5A6;" vertex="1" parent="1">
          <mxGeometry x="295" y="246" width="80" height="14" as="geometry" />
        </mxCell>
        <mxCell id="ws-handler" value="WebSocket" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFE082;strokeColor=#FFB300;fontColor=#2C3E50;fontStyle=0;fontSize=9;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="300" y="264" width="110" height="32" as="geometry" />
        </mxCell>
        <mxCell id="http-api" value="HTTP API" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFE082;strokeColor=#FFB300;fontColor=#2C3E50;fontStyle=0;fontSize=9;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="420" y="264" width="110" height="32" as="geometry" />
        </mxCell>
        <mxCell id="node-mgmt" value="Node Registry" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFE082;strokeColor=#FFB300;fontColor=#2C3E50;fontStyle=0;fontSize=9;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="300" y="301" width="110" height="32" as="geometry" />
        </mxCell>
        <mxCell id="cron-jobs" value="Cron Jobs" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFE082;strokeColor=#FFB300;fontColor=#2C3E50;fontStyle=0;fontSize=9;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="420" y="301" width="110" height="32" as="geometry" />
        </mxCell>
        <mxCell id="auth" value="Auth &amp; Routing" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFE082;strokeColor=#FFB300;fontColor=#2C3E50;fontStyle=0;fontSize=9;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="300" y="338" width="110" height="32" as="geometry" />
        </mxCell>
        <mxCell id="queue" value="Message Queue" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFE082;strokeColor=#FFB300;fontColor=#2C3E50;fontStyle=0;fontSize=9;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="420" y="338" width="110" height="32" as="geometry" />
        </mxCell>

        <!-- Gateway Flow Box -->
        <mxCell id="flow-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#FFB300;strokeWidth=1;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="560" y="243" width="340" height="130" as="geometry" />
        </mxCell>
        <mxCell id="flow-label" value="Request Flow" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=3;fontColor=#95A5A6;" vertex="1" parent="1">
          <mxGeometry x="570" y="246" width="100" height="14" as="geometry" />
        </mxCell>
        <mxCell id="flow-text" value="Channel → Auth → Route → Queue → Agent" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=0;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="585" y="268" width="280" height="18" as="geometry" />
        </mxCell>
        <mxCell id="flow-diagram" value="" style="endArrow=classic;html=1;strokeWidth=2;strokeColor=#FFB300;shadow=1;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="600" y="305" as="sourcePoint" />
            <mxPoint x="860" y="305" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="flow-step1" value="Entry" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FF8C42;strokeColor=#E67E22;fontColor=#FFFFFF;fontSize=9;fontStyle=1;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="595" y="325" width="55" height="25" as="geometry" />
        </mxCell>
        <mxCell id="flow-step2" value="Auth" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFE082;strokeColor=#FFB300;fontColor=#2C3E50;fontSize=9;fontStyle=1;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="660" y="325" width="55" height="25" as="geometry" />
        </mxCell>
        <mxCell id="flow-step3" value="Route" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFE082;strokeColor=#FFB300;fontColor=#2C3E50;fontSize=9;fontStyle=1;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="725" y="325" width="55" height="25" as="geometry" />
        </mxCell>
        <mxCell id="flow-step4" value="Agent" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#5B9BD5;strokeColor=#2980B9;fontColor=#FFFFFF;fontSize=9;fontStyle=1;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="790" y="325" width="55" height="25" as="geometry" />
        </mxCell>

        <!-- Arrow: Gateway to Agent -->
        <mxCell id="arrow-gateway-agent" value="" style="endArrow=classic;html=1;strokeWidth=2;strokeColor=#5B9BD5;shadow=1;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="500" y="380" as="sourcePoint" />
            <mxPoint x="500" y="400" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- AGENT LAYER (CORE) - Primary Blue #5B9BD5 with emphasis -->
        <mxCell id="agent-layer" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E8F4FD;strokeColor=#5B9BD5;strokeWidth=4;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="80" y="400" width="840" height="270" as="geometry" />
        </mxCell>
        <mxCell id="agent-star" value="★" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=20;fontColor=#5B9BD5;" vertex="1" parent="1">
          <mxGeometry x="90" y="403" width="25" height="25" as="geometry" />
        </mxCell>
        <mxCell id="agent-label" value="AGENT LAYER" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1;fontColor=#5B9BD5;" vertex="1" parent="1">
          <mxGeometry x="115" y="407" width="130" height="20" as="geometry" />
        </mxCell>
        <mxCell id="agent-core" value="[ CORE ]" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#3498DB;" vertex="1" parent="1">
          <mxGeometry x="250" y="409" width="60" height="18" as="geometry" />
        </mxCell>
        <mxCell id="agent-sublabel" value="Session Management, Memory, LLM Orchestration &amp; Tool Execution" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=0;fontColor=#95A5A6;" vertex="1" parent="1">
          <mxGeometry x="320" y="409" width="380" height="16" as="geometry" />
        </mxCell>

        <!-- Agent Core Components -->
        <mxCell id="session" value="Session&#xa;───────&#xa;短期记忆&#xa;对话上下文&#xa;工具状态" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#5B9BD5;strokeColor=#2980B9;fontColor=#FFFFFF;fontStyle=0;fontSize=10;shadow=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="100" y="435" width="110" height="85" as="geometry" />
        </mxCell>
        <mxCell id="memory" value="Memory&#xa;───────&#xa;长期记忆&#xa;向量检索&#xa;用户画像" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#5B9BD5;strokeColor=#2980B9;fontColor=#FFFFFF;fontStyle=0;fontSize=10;shadow=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="225" y="435" width="110" height="85" as="geometry" />
        </mxCell>
        <mxCell id="llm-orchestration" value="LLM Orchestration&#xa;─────────────&#xa;Provider Router&#xa;Streaming Handler&#xa;Token Management" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#5B9BD5;strokeColor=#2980B9;fontColor=#FFFFFF;fontStyle=0;fontSize=10;shadow=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="350" y="435" width="160" height="85" as="geometry" />
        </mxCell>

        <!-- Agentic Loop Box - Enhanced 8-Step Flow (Professional Light Theme) -->
        <mxCell id="agentic-loop-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#5B9BD5;strokeWidth=2;dashed=1;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="530" y="430" width="360" height="95" as="geometry" />
        </mxCell>
        <mxCell id="agentic-loop-label" value="Agentic Loop (8-Step Flow)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=3;fontColor=#5B9BD5;" vertex="1" parent="1">
          <mxGeometry x="640" y="433" width="140" height="16" as="geometry" />
        </mxCell>

        <!-- Step 1-2: User Message → AI Analyze (Primary Blue - Core services) -->
        <mxCell id="user-msg" value="User&#xa;Message" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E8F4FD;strokeColor=#5B9BD5;fontColor=#2C3E50;fontSize=8;fontStyle=0;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="545" y="455" width="52" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ai-analyze" value="AI&#xa;Analyze" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#5B9BD5;strokeColor=#2980B9;fontColor=#FFFFFF;fontSize=8;fontStyle=1;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="607" y="455" width="52" height="30" as="geometry" />
        </mxCell>

        <!-- Step 3-5: PreToolUse Hook (Queue/Yellow - middleware) → Execute Tool (Green - success) -->
        <mxCell id="pretool" value="PreTool&#xa;Hook" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFE082;strokeColor=#FFB300;fontColor=#2C3E50;fontSize=8;fontStyle=0;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="669" y="455" width="52" height="30" as="geometry" />
        </mxCell>
        <mxCell id="execute" value="Execute&#xa;Tool" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#66BB6A;strokeColor=#4CAF50;fontColor=#FFFFFF;fontSize=8;fontStyle=1;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="731" y="455" width="52" height="30" as="geometry" />
        </mxCell>
        <mxCell id="posttool" value="PostTool&#xa;Hook" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFE082;strokeColor=#FFB300;fontColor=#2C3E50;fontSize=8;fontStyle=0;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="793" y="455" width="52" height="30" as="geometry" />
        </mxCell>
        <mxCell id="result-return" value="Return&#xa;Result" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E8F5E9;strokeColor=#66BB6A;fontColor=#2C3E50;fontSize=8;fontStyle=0;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="855" y="455" width="50" height="30" as="geometry" />
        </mxCell>

        <!-- Arrows between steps -->
        <mxCell id="arrow1" value="" style="endArrow=classic;html=1;strokeWidth=1;strokeColor=#95A5A6;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="599" y="470" as="sourcePoint" />
            <mxPoint x="605" y="470" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow2" value="" style="endArrow=classic;html=1;strokeWidth=1;strokeColor=#95A5A6;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="661" y="470" as="sourcePoint" />
            <mxPoint x="667" y="470" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow3" value="" style="endArrow=classic;html=1;strokeWidth=1;strokeColor=#95A5A6;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="723" y="470" as="sourcePoint" />
            <mxPoint x="729" y="470" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow4" value="" style="endArrow=classic;html=1;strokeWidth=1;strokeColor=#95A5A6;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="785" y="470" as="sourcePoint" />
            <mxPoint x="791" y="470" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow5" value="" style="endArrow=classic;html=1;strokeWidth=1;strokeColor=#95A5A6;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="847" y="470" as="sourcePoint" />
            <mxPoint x="853" y="470" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- Loop arrow back to AI (Primary Blue - emphasis) -->
        <mxCell id="loop-arrow" value="" style="endArrow=classic;html=1;strokeWidth=2;curved=1;strokeColor=#5B9BD5;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="880" y="493" as="sourcePoint" />
            <mxPoint x="633" y="493" as="targetPoint" />
            <Array as="points">
              <mxPoint x="757" y="515" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="loop-text" value="iterate until complete" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=8;fontStyle=2;fontColor=#5B9BD5;" vertex="1" parent="1">
          <mxGeometry x="720" y="503" width="90" height="14" as="geometry" />
        </mxCell>

        <!-- TOOLS Box -->
        <mxCell id="tools-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#5B9BD5;strokeWidth=2;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="100" y="535" width="800" height="120" as="geometry" />
        </mxCell>
        <mxCell id="tools-label" value="TOOLS" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#5B9BD5;" vertex="1" parent="1">
          <mxGeometry x="110" y="540" width="60" height="16" as="geometry" />
        </mxCell>
        <mxCell id="tools-sublabel" value="AI ↔ Tool Interaction Layer" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=2;fontColor=#95A5A6;" vertex="1" parent="1">
          <mxGeometry x="180" y="542" width="150" height="14" as="geometry" />
        </mxCell>

        <!-- Tool Categories -->
        <mxCell id="file-ops" value="File Operations&#xa;─────────&#xa;Read / Write&#xa;Edit / Glob / Grep" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#66BB6A;strokeColor=#4CAF50;fontColor=#FFFFFF;fontStyle=0;fontSize=9;shadow=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="120" y="563" width="120" height="75" as="geometry" />
        </mxCell>
        <mxCell id="browser" value="Browser&#xa;─────────&#xa;Web Fetch&#xa;Search / Navigate" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#66BB6A;strokeColor=#4CAF50;fontColor=#FFFFFF;fontStyle=0;fontSize=9;shadow=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="255" y="563" width="120" height="75" as="geometry" />
        </mxCell>
        <mxCell id="shell" value="Shell Execution&#xa;─────────&#xa;Bash / Python&#xa;Node.js" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#66BB6A;strokeColor=#4CAF50;fontColor=#FFFFFF;fontStyle=0;fontSize=9;shadow=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="390" y="563" width="120" height="75" as="geometry" />
        </mxCell>
        <mxCell id="mcp-tools" value="MCP Tools&#xa;─────────&#xa;Calendar / Email&#xa;Database / APIs" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#AB47BC;strokeColor=#8E24AA;fontColor=#FFFFFF;fontStyle=0;fontSize=9;shadow=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="525" y="563" width="120" height="75" as="geometry" />
        </mxCell>
        <mxCell id="skills" value="Skills&#xa;─────────&#xa;/commit /review&#xa;/test /deploy /doc" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#EF5350;strokeColor=#E53935;fontColor=#FFFFFF;fontStyle=0;fontSize=9;shadow=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="660" y="563" width="120" height="75" as="geometry" />
        </mxCell>

        <!-- Arrow: Agent to External -->
        <mxCell id="arrow-agent-external" value="" style="endArrow=classic;html=1;strokeWidth=2;strokeColor=#5B9BD5;shadow=1;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="500" y="670" as="sourcePoint" />
            <mxPoint x="500" y="690" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- EXTERNAL SERVICES - Purple Theme #AB47BC -->
        <mxCell id="external-layer" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F3E5F5;strokeColor=#AB47BC;strokeWidth=2;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="80" y="690" width="840" height="100" as="geometry" />
        </mxCell>
        <mxCell id="external-label" value="EXTERNAL SERVICES" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=13;fontStyle=1;fontColor=#AB47BC;" vertex="1" parent="1">
          <mxGeometry x="90" y="695" width="180" height="18" as="geometry" />
        </mxCell>
        <mxCell id="external-sublabel" value="LLM Providers &amp; External APIs" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=0;fontColor=#95A5A6;" vertex="1" parent="1">
          <mxGeometry x="280" y="697" width="180" height="16" as="geometry" />
        </mxCell>

        <mxCell id="anthropic" value="Anthropic&#xa;Claude&#xa;Opus / Sonnet / Haiku" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#AB47BC;strokeColor=#8E24AA;fontColor=#FFFFFF;fontStyle=0;fontSize=9;shadow=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="120" y="720" width="140" height="55" as="geometry" />
        </mxCell>
        <mxCell id="openai" value="OpenAI&#xa;GPT-4o / o1 / o3" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#AB47BC;strokeColor=#8E24AA;fontColor=#FFFFFF;fontStyle=0;fontSize=9;shadow=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="280" y="720" width="140" height="55" as="geometry" />
        </mxCell>
        <mxCell id="google" value="Google&#xa;Gemini 2.0" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#AB47BC;strokeColor=#8E24AA;fontColor=#FFFFFF;fontStyle=0;fontSize=9;shadow=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="440" y="720" width="140" height="55" as="geometry" />
        </mxCell>
        <mxCell id="deepgram" value="Deepgram&#xa;STT / TTS" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#AB47BC;strokeColor=#8E24AA;fontColor=#FFFFFF;fontStyle=0;fontSize=9;shadow=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="600" y="720" width="140" height="55" as="geometry" />
        </mxCell>
        <mxCell id="other-apis" value="Other APIs&#xa;..." style="rounded=1;whiteSpace=wrap;html=1;fillColor=#CE93D8;strokeColor=#AB47BC;fontColor=#2C3E50;fontStyle=0;fontSize=9;shadow=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="760" y="720" width="100" height="55" as="geometry" />
        </mxCell>

        <!-- INFRASTRUCTURE (Vertical Right Side) - Green Theme #66BB6A -->
        <mxCell id="infra-layer" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E8F5E9;strokeColor=#66BB6A;strokeWidth=2;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="950" y="85" width="180" height="705" as="geometry" />
        </mxCell>
        <mxCell id="infra-label" value="INFRASTRUCTURE" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1;fontColor=#66BB6A;" vertex="1" parent="1">
          <mxGeometry x="960" y="92" width="160" height="18" as="geometry" />
        </mxCell>
        <mxCell id="infra-sublabel" value="Shared Services Layer" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=9;fontStyle=2;fontColor=#95A5A6;" vertex="1" parent="1">
          <mxGeometry x="960" y="112" width="160" height="14" as="geometry" />
        </mxCell>

        <mxCell id="config-mgr" value="Config Manager" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#66BB6A;strokeColor=#4CAF50;fontColor=#FFFFFF;fontStyle=0;fontSize=10;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="970" y="135" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="media-proc" value="Media Processing" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#66BB6A;strokeColor=#4CAF50;fontColor=#FFFFFF;fontStyle=0;fontSize=10;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="970" y="185" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="memory-store" value="Memory Store" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#66BB6A;strokeColor=#4CAF50;fontColor=#FFFFFF;fontStyle=0;fontSize=10;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="970" y="235" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sessions-mgr" value="Sessions Manager" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#66BB6A;strokeColor=#4CAF50;fontColor=#FFFFFF;fontStyle=0;fontSize=10;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="970" y="285" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="logging" value="Logging (tslog)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#66BB6A;strokeColor=#4CAF50;fontColor=#FFFFFF;fontStyle=0;fontSize=10;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="970" y="335" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="tool-sandbox" value="Tool Sandbox&#xa;Docker Isolation" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#66BB6A;strokeColor=#4CAF50;fontColor=#FFFFFF;fontStyle=0;fontSize=10;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="970" y="385" width="140" height="50" as="geometry" />
        </mxCell>
        <mxCell id="hooks-system" value="Hooks System&#xa;PreToolUse / PostToolUse&#xa;Notification" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFE082;strokeColor=#FFB300;fontColor=#2C3E50;fontStyle=0;fontSize=9;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="970" y="445" width="140" height="60" as="geometry" />
        </mxCell>
        <mxCell id="binaries-mgr" value="Binaries Manager" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#66BB6A;strokeColor=#4CAF50;fontColor=#FFFFFF;fontStyle=0;fontSize=10;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="970" y="515" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="security" value="Security Sandbox" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#66BB6A;strokeColor=#4CAF50;fontColor=#FFFFFF;fontStyle=0;fontSize=10;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="970" y="565" width="140" height="40" as="geometry" />
        </mxCell>

        <!-- Servant Pattern Note -->
        <mxCell id="servant-pattern" value="Servant Pattern&#xa;─────────────&#xa;Single Direction&#xa;All layers can call↑&#xa;Never reverse deps" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFF8E1;strokeColor=#FFB300;fontSize=9;fontStyle=0;align=center;shadow=0;" vertex="1" parent="1">
          <mxGeometry x="970" y="620" width="140" height="80" as="geometry" />
        </mxCell>

        <!-- Arrow: Main layers to Infrastructure -->
        <mxCell id="arrow-to-infra1" value="" style="endArrow=classic;html=1;strokeWidth=1;dashed=1;strokeColor=#66BB6A;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="920" y="150" as="sourcePoint" />
            <mxPoint x="950" y="150" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow-to-infra2" value="" style="endArrow=classic;html=1;strokeWidth=1;dashed=1;strokeColor=#66BB6A;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="920" y="300" as="sourcePoint" />
            <mxPoint x="950" y="300" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow-to-infra3" value="" style="endArrow=classic;html=1;strokeWidth=1;dashed=1;strokeColor=#66BB6A;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="920" y="520" as="sourcePoint" />
            <mxPoint x="950" y="520" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow-to-infra4" value="" style="endArrow=classic;html=1;strokeWidth=1;dashed=1;strokeColor=#66BB6A;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="920" y="720" as="sourcePoint" />
            <mxPoint x="950" y="720" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- Legend -->
        <mxCell id="legend-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#BDC3C7;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="1150" y="85" width="200" height="220" as="geometry" />
        </mxCell>
        <mxCell id="legend-title" value="Legend" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1;fontColor=#2C3E50;" vertex="1" parent="1">
          <mxGeometry x="1160" y="92" width="60" height="18" as="geometry" />
        </mxCell>

        <mxCell id="legend-entry" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FF8C42;strokeColor=#E67E22;" vertex="1" parent="1">
          <mxGeometry x="1160" y="118" width="18" height="14" as="geometry" />
        </mxCell>
        <mxCell id="legend-entry-text" value="Entry / Gateway" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#2C3E50;" vertex="1" parent="1">
          <mxGeometry x="1185" y="115" width="100" height="20" as="geometry" />
        </mxCell>

        <mxCell id="legend-core" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#5B9BD5;strokeColor=#2980B9;" vertex="1" parent="1">
          <mxGeometry x="1160" y="140" width="18" height="14" as="geometry" />
        </mxCell>
        <mxCell id="legend-core-text" value="★ Agent (Core)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#5B9BD5;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="1185" y="137" width="100" height="20" as="geometry" />
        </mxCell>

        <mxCell id="legend-infra" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#66BB6A;strokeColor=#4CAF50;" vertex="1" parent="1">
          <mxGeometry x="1160" y="162" width="18" height="14" as="geometry" />
        </mxCell>
        <mxCell id="legend-infra-text" value="Infrastructure / Tools" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#2C3E50;" vertex="1" parent="1">
          <mxGeometry x="1185" y="159" width="110" height="20" as="geometry" />
        </mxCell>

        <mxCell id="legend-external" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#AB47BC;strokeColor=#8E24AA;" vertex="1" parent="1">
          <mxGeometry x="1160" y="184" width="18" height="14" as="geometry" />
        </mxCell>
        <mxCell id="legend-external-text" value="External / MCP" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#2C3E50;" vertex="1" parent="1">
          <mxGeometry x="1185" y="181" width="100" height="20" as="geometry" />
        </mxCell>

        <mxCell id="legend-hooks" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFE082;strokeColor=#FFB300;" vertex="1" parent="1">
          <mxGeometry x="1160" y="206" width="18" height="14" as="geometry" />
        </mxCell>
        <mxCell id="legend-hooks-text" value="Hooks / Middleware" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#2C3E50;" vertex="1" parent="1">
          <mxGeometry x="1185" y="203" width="110" height="20" as="geometry" />
        </mxCell>

        <mxCell id="legend-line1" style="endArrow=classic;html=1;strokeWidth=2;strokeColor=#5B9BD5;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1160" y="235" as="sourcePoint" />
            <mxPoint x="1178" y="235" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="legend-line1-text" value="Data Flow" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#2C3E50;" vertex="1" parent="1">
          <mxGeometry x="1185" y="228" width="70" height="18" as="geometry" />
        </mxCell>

        <mxCell id="legend-line2" style="endArrow=classic;html=1;strokeWidth=1;dashed=1;strokeColor=#66BB6A;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1160" y="255" as="sourcePoint" />
            <mxPoint x="1178" y="255" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="legend-line2-text" value="Infra Access" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#2C3E50;" vertex="1" parent="1">
          <mxGeometry x="1185" y="248" width="70" height="18" as="geometry" />
        </mxCell>

        <mxCell id="legend-loop-demo" value="" style="endArrow=classic;html=1;strokeWidth=2;curved=1;strokeColor=#5B9BD5;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1178" y="278" as="sourcePoint" />
            <mxPoint x="1160" y="278" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1169" y="288" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="legend-loop-text" value="Agentic Loop" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#5B9BD5;fontStyle=2;" vertex="1" parent="1">
          <mxGeometry x="1185" y="271" width="80" height="18" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
